# [QO-1] 리포트 상태 플래그 및 롤백/숨김

## Problem 1-Pager
- 배경: 리포트가 잘못 게시돼도 숨기거나 롤백할 상태 관리가 없어 사용자에게 오류 콘텐츠가 노출될 위험이 있다.
- 문제: (1) 상태 필드 부재로 게시/숨김을 표현할 수 없음, (2) UI에서 숨김/복구 액션이 없고 목록/상세에 상태가 표시되지 않음, (3) API가 인증 없이 열려 있어 최소한의 보호도 없다(플래그/훅 필요).
- 목표: draft/published/hidden 상태를 도입하고, 운영자가 숨김/복구할 수 있는 API와 UI 배지를 제공해 잘못된 리포트를 빠르게 차단한다.
- 비목표: 역할 기반 접근 제어, 알림 연계, 복잡한 승인 워크플로.
- 제약: 파일≤300LOC/함수≤50LOC, 민감정보 미로그, 새 코드에 테스트 추가, 기본적으로 관리자 보호 미도입(훅만 남김).

## 대안 비교
- Option A: 상태 필드 추가 + 단순 PATCH/PUT 엔드포인트 + UI 버튼 — 장점: 구현 단순, 즉시 효과. 단점: 인증 부재 시 누구나 호출 가능. **선택**
- Option B: 상태 필드 + 토큰 기반 간단 보호 — 장점: 무단 변경 완화. 단점: 추가 설정 필요, 임시 토큰 관리 비용. 보류(훅만 남김).

## 범위/비범위
- 포함: report_snapshot에 status 필드 추가(default published), 상태 변경 API, 목록/상세 상태 배지, 숨김/복구 버튼, 숨김 시 기본 조회 제외(필터로 포함 가능).
- 제외: 역할/인증, 알림/이벤트 발행, 상태 변경 감사 로그.

## 수용 기준
- 새 리포트는 기본 published.
- 상태 hidden이면 목록 기본 조회에서 제외되고 상세도 접근 시 적절히 표시되며 숨김 배지 노출.
- 상태 draft/hidden에서 published로 복구 가능, UI 버튼/배지로 확인 가능.

## 테스트
- 단위/통합: 상태 업데이트 API 응답/DB 반영, hidden 시 기본 리스트 제외, 복구 시 재노출. UI는 E2E 또는 수동 확인.

## 리스크/의존성
- 인증 부재로 무단 상태 변경 가능성 → env 플래그/미들웨어 훅 여지 남김.
- 캐시가 있다면 동기화 지연 가능 → 현재 DB 조회 기준으로 단순 처리.*** End Patch** ***!
